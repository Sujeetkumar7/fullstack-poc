<h2 mat-dialog-title class="dialog-title">
  Invest
  <button class="close-btn" aria-label="Close" (click)="onClose()">
    <i class="bi bi-x-lg"></i>
  </button>
</h2>

<div mat-dialog-content>
  <div class="form-container">
    <form [formGroup]="investingForm" class="d-flex flex-column gap-3">
      <div class="d-flex gap-3 flex-wrap">
        <div class="info-card flex-fill">
          <div class="label">
            <i class="bi bi-person me-2"></i> User
          </div>
          <div class="value">{{ data.userName }}</div>
        </div>

         <div class="info-card flex-fill">
          <div class="label">
            <i class="bi bi-wallet2 me-2"></i> Balance
          </div>
          <div class="value text-success">
            {{ data.balance | currency:'INR':'symbol':'1.0-0' }}
          </div>
        </div>
      </div>
       <div class="d-flex gap-3 flex-wrap">
         <div class="info-card flex-fill">
          <div class="label">
            <i class="bi bi-building me-2"></i> Stock Name
          </div>
          <div class="value">{{ data.row.DispSym }}</div>
        </div>
        <div class="info-card flex-fill">
          <div class="label">
            <i class="bi bi-graph-up me-2"></i> Price Per Unit
          </div>
          <div class="value text-success">
            {{ data.row.Ltp | currency:'INR':'symbol':'1.0-0' }}
          </div>
        </div>
       </div>
      <div class="info-card">
        <div class="label">
          <i class="bi bi-calculator me-2"></i> Quantity
        </div>
        <input id="quantity" type="number" class="form-control form-control-sm"
               formControlName="quantity" placeholder="Enter quantity" />
        <div *ngIf="investingForm.get('quantity')?.invalid && investingForm.get('quantity')?.touched"
             class="text-danger mt-1 small">
          Quantity must be at least 1.
        </div>
      </div>
      <div class="info-card">
        <div class="label">
          <i class="bi bi-credit-card me-2"></i> Amount
        </div>
        <div class="value text-primary">
          â‚¹{{ calculatedAmount.toFixed(2) }}
        </div>
        <div *ngIf="investingForm.errors?.['insufficientBalance']"
             class="text-danger mt-1 small">
          Amount exceeds current balance.
        </div>
      </div>

    </form>
  </div>
</div>

<div class="dialog-footer-separator"></div>

<!-- Action Buttons -->
<div mat-dialog-actions class="dialog-actions">
  <button type="button" class="btn btn-cancel" (click)="onClose()">
    <i class="bi bi-x-circle me-2"></i> Cancel
  </button>
  <button type="button" class="btn btn-buy" (click)="submit('buy')" [disabled]="!investingForm.valid">
    <i class="bi bi-cart-plus me-2"></i> Buy
  </button>
  <button type="button" class="btn btn-sell" (click)="submit('sell')" [disabled]="!investingForm.valid">
    <i class="bi bi-cart-dash me-2"></i> Sell
  </button>
</div>